Question_ID,Business_Question,SQL_Query,Expected_Use_Case,Data_Category
Q001,"How many total users do we have?","SELECT COUNT(*) as TotalUsers FROM UserRecords","User Count Analysis","User Management"
Q002,"How many active users do we have?","SELECT COUNT(*) as ActiveUsers FROM UserRecords WHERE AccountEnabled = 1","Active User Analysis","User Management"
Q003,"How many inactive users do we have?","SELECT COUNT(*) as InactiveUsers FROM UserRecords WHERE AccountEnabled = 0","Inactive User Analysis","User Management"
Q004,"How many licensed users do we have?","SELECT COUNT(*) as LicensedUsers FROM UserRecords WHERE IsLicensed = 1","License Analysis","License Management"
Q005,"How many unlicensed users do we have?","SELECT COUNT(*) as UnlicensedUsers FROM UserRecords WHERE IsLicensed = 0 OR IsLicensed IS NULL","License Analysis","License Management"
Q006,"Show me users by department","SELECT Department, COUNT(*) as UserCount FROM UserRecords WHERE Department IS NOT NULL GROUP BY Department ORDER BY UserCount DESC","Department Analysis","Organizational Structure"
Q007,"Which department has the most users?","SELECT TOP 1 Department, COUNT(*) as UserCount FROM UserRecords WHERE Department IS NOT NULL GROUP BY Department ORDER BY UserCount DESC","Top Department Analysis","Organizational Structure"
Q008,"Show me users by country","SELECT Country, COUNT(*) as UserCount FROM UserRecords WHERE Country IS NOT NULL GROUP BY Country ORDER BY UserCount DESC","Geographic Analysis","User Distribution"
Q009,"Which country has the most users?","SELECT TOP 1 Country, COUNT(*) as UserCount FROM UserRecords WHERE Country IS NOT NULL GROUP BY Country ORDER BY UserCount DESC","Top Country Analysis","User Distribution"
Q010,"Show me users from India","SELECT UserID, Mail, DisplayName, Department FROM UserRecords WHERE Country = 'India'","Country-specific User List","User Distribution"
Q051,"Show me total cost by department","SELECT ur.Department, SUM(COALESCE(l.ActualCost, l.PartnerCost)) as TotalCost FROM UserRecords ur JOIN Licenses l ON ur.Licenses LIKE '%' + l.Id + '%' WHERE ur.Department IS NOT NULL AND ur.Licenses IS NOT NULL GROUP BY ur.Department ORDER BY TotalCost DESC","Department Cost Analysis","Cost Management"
Q052,"Which department spent the most on licenses?","SELECT TOP 1 ur.Department, SUM(COALESCE(l.ActualCost, l.PartnerCost)) as TotalSpent FROM UserRecords ur JOIN Licenses l ON ur.Licenses LIKE '%' + l.Id + '%' WHERE ur.Department IS NOT NULL AND ur.Licenses IS NOT NULL GROUP BY ur.Department ORDER BY TotalSpent DESC","Top Spending Department","Cost Management"
Q053,"Show me license costs by country","SELECT ur.Country, SUM(COALESCE(l.ActualCost, l.PartnerCost)) as TotalCost FROM UserRecords ur JOIN Licenses l ON ur.Licenses LIKE '%' + l.Id + '%' WHERE ur.Country IS NOT NULL AND ur.Licenses IS NOT NULL GROUP BY ur.Country ORDER BY TotalCost DESC","Country Cost Analysis","Cost Management"
Q054,"Show me most expensive licenses","SELECT l.LicenseName, COALESCE(l.ActualCost, l.PartnerCost) as EffectiveCost, l.ActualCost, l.PartnerCost FROM Licenses l WHERE COALESCE(l.ActualCost, l.PartnerCost) IS NOT NULL ORDER BY EffectiveCost DESC","Expensive License Analysis","Cost Management"
Q055,"Show me total Microsoft 365 spending","SELECT SUM(COALESCE(l.ActualCost, l.PartnerCost)) as TotalM365Cost FROM UserRecords ur JOIN Licenses l ON ur.Licenses LIKE '%' + l.Id + '%' WHERE (l.LicenseName LIKE '%Microsoft 365%' OR l.LicenseName LIKE '%Office 365%') AND ur.Licenses IS NOT NULL","M365 Cost Analysis","Cost Management"
Q056,"Show me cost per user by department","SELECT ur.Department, COUNT(*) as UserCount, SUM(COALESCE(l.ActualCost, l.PartnerCost)) as TotalCost, SUM(COALESCE(l.ActualCost, l.PartnerCost)) / COUNT(*) as CostPerUser FROM UserRecords ur JOIN Licenses l ON ur.Licenses LIKE '%' + l.Id + '%' WHERE ur.Department IS NOT NULL AND ur.Licenses IS NOT NULL GROUP BY ur.Department ORDER BY CostPerUser DESC","Cost Per User Analysis","Cost Management"
Q057,"Show me licenses with missing actual cost","SELECT l.LicenseName, l.ActualCost, l.PartnerCost, COUNT(*) as UsageCount FROM Licenses l LEFT JOIN UserRecords ur ON ur.Licenses LIKE '%' + l.Id + '%' WHERE l.ActualCost IS NULL AND l.PartnerCost IS NOT NULL GROUP BY l.LicenseName, l.ActualCost, l.PartnerCost ORDER BY UsageCount DESC","Missing Cost Analysis","Cost Management"
Q058,"Show me cost breakdown by license type","SELECT l.LicenseName, COUNT(*) as UserCount, SUM(COALESCE(l.ActualCost, l.PartnerCost)) as TotalCost, AVG(COALESCE(l.ActualCost, l.PartnerCost)) as AvgCost FROM UserRecords ur JOIN Licenses l ON ur.Licenses LIKE '%' + l.Id + '%' WHERE ur.Licenses IS NOT NULL GROUP BY l.LicenseName ORDER BY TotalCost DESC","License Cost Breakdown","Cost Management"
Q059,"Show me users with highest license costs","SELECT ur.DisplayName, ur.Mail, ur.Department, SUM(COALESCE(l.ActualCost, l.PartnerCost)) as TotalUserCost FROM UserRecords ur JOIN Licenses l ON ur.Licenses LIKE '%' + l.Id + '%' WHERE ur.Licenses IS NOT NULL GROUP BY ur.DisplayName, ur.Mail, ur.Department ORDER BY TotalUserCost DESC","High Cost Users","Cost Management"
Q060,"Show me departments with cost efficiency metrics","SELECT ur.Department, COUNT(*) as UserCount, SUM(COALESCE(l.ActualCost, l.PartnerCost)) as TotalCost, SUM(COALESCE(l.ActualCost, l.PartnerCost)) / COUNT(*) as CostPerUser, SUM(ur.EmailSent_D30 + ur.EmailReceive_D30) as TotalEmailActivity, (SUM(ur.EmailSent_D30 + ur.EmailReceive_D30) / COUNT(*)) / NULLIF(SUM(COALESCE(l.ActualCost, l.PartnerCost)) / COUNT(*), 0) as ActivityCostRatio FROM UserRecords ur JOIN Licenses l ON ur.Licenses LIKE '%' + l.Id + '%' WHERE ur.Department IS NOT NULL AND ur.Licenses IS NOT NULL GROUP BY ur.Department ORDER BY ActivityCostRatio DESC","Cost Efficiency Analysis","Cost Management"
Q061,"Show me annual license spend projection","SELECT l.LicenseName, COUNT(*) as UserCount, SUM(COALESCE(l.ActualCost, l.PartnerCost)) as MonthlyCost, SUM(COALESCE(l.ActualCost, l.PartnerCost)) * 12 as AnnualProjection FROM UserRecords ur JOIN Licenses l ON ur.Licenses LIKE '%' + l.Id + '%' WHERE ur.Licenses IS NOT NULL GROUP BY l.LicenseName ORDER BY AnnualProjection DESC","Annual Cost Projection","Cost Management"
Q062,"Show me cost comparison actual vs partner","SELECT l.LicenseName, COUNT(*) as UserCount, SUM(l.ActualCost) as TotalActualCost, SUM(l.PartnerCost) as TotalPartnerCost, SUM(COALESCE(l.ActualCost, l.PartnerCost)) as EffectiveCost, SUM(CASE WHEN l.ActualCost IS NULL THEN l.PartnerCost ELSE 0 END) as FallbackCostUsed FROM UserRecords ur JOIN Licenses l ON ur.Licenses LIKE '%' + l.Id + '%' WHERE ur.Licenses IS NOT NULL GROUP BY l.LicenseName ORDER BY EffectiveCost DESC","Cost Comparison Analysis","Cost Management"
Q063,"Show me trial vs paid license costs","SELECT CASE WHEN l.IsTrial = 1 THEN 'Trial' ELSE 'Paid' END as LicenseType, COUNT(*) as UserCount, SUM(COALESCE(l.ActualCost, l.PartnerCost)) as TotalCost, AVG(COALESCE(l.ActualCost, l.PartnerCost)) as AvgCost FROM UserRecords ur JOIN Licenses l ON ur.Licenses LIKE '%' + l.Id + '%' WHERE ur.Licenses IS NOT NULL GROUP BY CASE WHEN l.IsTrial = 1 THEN 'Trial' ELSE 'Paid' END ORDER BY TotalCost DESC","Trial vs Paid Cost Analysis","Cost Management"
Q064,"Show me cost by user activity level","SELECT CASE WHEN ur.EmailSent_D30 + ur.EmailReceive_D30 > 500 THEN 'High Activity' WHEN ur.EmailSent_D30 + ur.EmailReceive_D30 > 100 THEN 'Medium Activity' WHEN ur.EmailSent_D30 + ur.EmailReceive_D30 > 0 THEN 'Low Activity' ELSE 'No Activity' END as ActivityLevel, COUNT(*) as UserCount, SUM(COALESCE(l.ActualCost, l.PartnerCost)) as TotalCost, AVG(COALESCE(l.ActualCost, l.PartnerCost)) as AvgCostPerUser FROM UserRecords ur JOIN Licenses l ON ur.Licenses LIKE '%' + l.Id + '%' WHERE ur.Licenses IS NOT NULL GROUP BY CASE WHEN ur.EmailSent_D30 + ur.EmailReceive_D30 > 500 THEN 'High Activity' WHEN ur.EmailSent_D30 + ur.EmailReceive_D30 > 100 THEN 'Medium Activity' WHEN ur.EmailSent_D30 + ur.EmailReceive_D30 > 0 THEN 'Low Activity' ELSE 'No Activity' END ORDER BY TotalCost DESC","Activity-Based Cost Analysis","Cost Management"
Q065,"Show me license utilization and cost efficiency","SELECT l.LicenseName, l.TotalUnits, l.ConsumedUnits, CAST(l.ConsumedUnits AS FLOAT) / NULLIF(l.TotalUnits, 0) * 100 as UtilizationPercent, SUM(COALESCE(l.ActualCost, l.PartnerCost)) as TotalCost, SUM(COALESCE(l.ActualCost, l.PartnerCost)) / NULLIF(l.ConsumedUnits, 0) as CostPerConsumedUnit FROM UserRecords ur JOIN Licenses l ON ur.Licenses LIKE '%' + l.Id + '%' WHERE ur.Licenses IS NOT NULL AND l.TotalUnits > 0 GROUP BY l.LicenseName, l.TotalUnits, l.ConsumedUnits ORDER BY UtilizationPercent DESC","License Utilization Efficiency","Cost Management"