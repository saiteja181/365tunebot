Question_ID,Business_Question,SQL_Query,Expected_Use_Case,Data_Category
Q001,"How many total users do we have?","SELECT COUNT(*) as TotalUsers FROM UserRecords","User Count Analysis","User Management"
Q002,"How many active users do we have?","SELECT COUNT(*) as ActiveUsers FROM UserRecords WHERE AccountEnabled = 1","Active User Analysis","User Management"
Q003,"How many inactive users do we have?","SELECT COUNT(*) as InactiveUsers FROM UserRecords WHERE AccountEnabled = 0","Inactive User Analysis","User Management"
Q004,"How many licensed users do we have?","SELECT COUNT(*) as LicensedUsers FROM UserRecords WHERE IsLicensed = 1","License Analysis","License Management"
Q005,"How many unlicensed users do we have?","SELECT COUNT(*) as UnlicensedUsers FROM UserRecords WHERE IsLicensed = 0 OR IsLicensed IS NULL","License Analysis","License Management"
Q006,"Show me users by department","SELECT Department, COUNT(*) as UserCount FROM UserRecords WHERE Department IS NOT NULL GROUP BY Department ORDER BY UserCount DESC","Department Analysis","Organizational Structure"
Q007,"Which department has the most users?","SELECT TOP 1 Department, COUNT(*) as UserCount FROM UserRecords WHERE Department IS NOT NULL GROUP BY Department ORDER BY UserCount DESC","Top Department Analysis","Organizational Structure"
Q008,"Show me users by country","SELECT Country, COUNT(*) as UserCount FROM UserRecords WHERE Country IS NOT NULL GROUP BY Country ORDER BY UserCount DESC","Geographic Analysis","User Distribution"
Q009,"Which country has the most users?","SELECT TOP 1 Country, COUNT(*) as UserCount FROM UserRecords WHERE Country IS NOT NULL GROUP BY Country ORDER BY UserCount DESC","Top Country Analysis","User Distribution"
Q010,"Show me users from India","SELECT UserID, Mail, DisplayName, Department FROM UserRecords WHERE Country = 'India'","Country-specific User List","User Distribution"
Q011,"How many users are from India?","SELECT COUNT(*) as IndiaUsers FROM UserRecords WHERE Country = 'India'","India User Count","User Distribution"
Q012,"Show me users in IT department","SELECT UserID, Mail, DisplayName, Country FROM UserRecords WHERE Department = 'IT' OR Department = 'Information Technology'","Department-specific User List","Organizational Structure"
Q013,"How many users are in IT department?","SELECT COUNT(*) as ITUsers FROM UserRecords WHERE Department = 'IT' OR Department = 'Information Technology'","IT Department Count","Organizational Structure"
Q014,"Show me users who haven't signed in recently","SELECT UserID, Mail, DisplayName, Department, LastSignInDateTime FROM UserRecords WHERE LastSignInDateTime < DATEADD(day, -30, GETDATE()) OR LastSignInDateTime IS NULL","Inactive Users Analysis","User Activity"
Q015,"Show me users who signed in today","SELECT UserID, Mail, DisplayName, Department, LastSignInDateTime FROM UserRecords WHERE CAST(LastSignInDateTime AS DATE) = CAST(GETDATE() AS DATE)","Recent Login Analysis","User Activity"
Q016,"Show me users with MFA disabled","SELECT UserID, Mail, DisplayName, Department, IsMFADisabled FROM UserRecords WHERE IsMFADisabled = 1","Security Analysis","Security Compliance"
Q017,"How many users have MFA enabled?","SELECT COUNT(*) as MFAEnabledUsers FROM UserRecords WHERE IsMFADisabled = 0 OR IsMFADisabled IS NULL","MFA Compliance Count","Security Compliance"
Q018,"Show me users by user type","SELECT UserType, COUNT(*) as UserCount FROM UserRecords WHERE UserType IS NOT NULL GROUP BY UserType ORDER BY UserCount DESC","User Type Analysis","User Management"
Q019,"How many guest users do we have?","SELECT COUNT(*) as GuestUsers FROM UserRecords WHERE UserType = 'Guest' OR UserType LIKE '%Guest%'","Guest User Count","User Management"
Q020,"Show me users who sent the most emails","SELECT TOP 10 UserID, Mail, DisplayName, EmailSent FROM UserRecords WHERE EmailSent IS NOT NULL ORDER BY EmailSent DESC","Top Email Senders","Communication Analysis"
Q021,"Show me users who received the most emails","SELECT TOP 10 UserID, Mail, DisplayName, EmailReceived FROM UserRecords WHERE EmailReceived IS NOT NULL ORDER BY EmailReceived DESC","Top Email Recipients","Communication Analysis"
Q022,"Show me email activity in the last 30 days","SELECT UserID, Mail, DisplayName, EmailSent_D30, EmailReceive_D30 FROM UserRecords WHERE (EmailSent_D30 > 0 OR EmailReceive_D30 > 0)","Recent Email Activity","Communication Analysis"
Q023,"Show me users with no email activity","SELECT UserID, Mail, DisplayName, Department FROM UserRecords WHERE (EmailSent IS NULL OR EmailSent = 0) AND (EmailReceived IS NULL OR EmailReceived = 0)","Inactive Email Users","Communication Analysis"
Q024,"Show me meeting activity in the last 30 days","SELECT UserID, Mail, DisplayName, Meeting_Created_Count_30, Meeting_Interacted_Count_30 FROM UserRecords WHERE (Meeting_Created_Count_30 > 0 OR Meeting_Interacted_Count_30 > 0)","Recent Meeting Activity","Collaboration Analysis"
Q025,"Show me users who created the most meetings","SELECT TOP 10 UserID, Mail, DisplayName, Meeting_Created_Count_180 FROM UserRecords WHERE Meeting_Created_Count_180 IS NOT NULL ORDER BY Meeting_Created_Count_180 DESC","Top Meeting Organizers","Collaboration Analysis"
Q026,"Show me average email activity by department","SELECT Department, AVG(CAST(EmailSent AS FLOAT)) as AvgEmailsSent, AVG(CAST(EmailReceived AS FLOAT)) as AvgEmailsReceived FROM UserRecords WHERE Department IS NOT NULL GROUP BY Department ORDER BY AvgEmailsSent DESC","Department Email Analysis","Communication Analysis"
Q027,"Show me users with Exchange Online activity","SELECT UserID, Mail, DisplayName, LastExchangeOnlineLogin FROM UserRecords WHERE LastExchangeOnlineLogin IS NOT NULL ORDER BY LastExchangeOnlineLogin DESC","Exchange Activity Analysis","Service Usage"
Q028,"Show me users with Entra ID activity","SELECT UserID, Mail, DisplayName, LastEntraIdLogin FROM UserRecords WHERE LastEntraIdLogin IS NOT NULL ORDER BY LastEntraIdLogin DESC","Entra ID Activity Analysis","Service Usage"
Q029,"Show me user distribution by company","SELECT CompanyName, COUNT(*) as UserCount FROM UserRecords WHERE CompanyName IS NOT NULL GROUP BY CompanyName ORDER BY UserCount DESC","Company Analysis","Organizational Structure"
Q030,"Show me managers and their team sizes","SELECT ManagerName, COUNT(*) as TeamSize FROM UserRecords WHERE ManagerName IS NOT NULL GROUP BY ManagerName ORDER BY TeamSize DESC","Management Structure","Organizational Structure"
Q031,"Show me users without managers","SELECT UserID, Mail, DisplayName, Department FROM UserRecords WHERE ManagerName IS NULL OR ManagerName = ''","Unmanaged Users","Organizational Structure"
Q032,"Show me license utilization summary","SELECT IsLicensed, COUNT(*) as UserCount, CAST(COUNT(*) * 100.0 / (SELECT COUNT(*) FROM UserRecords) AS DECIMAL(5,2)) as Percentage FROM UserRecords GROUP BY IsLicensed","License Utilization","License Management"
Q033,"Show me account status distribution","SELECT AccountEnabled, COUNT(*) as UserCount FROM UserRecords GROUP BY AccountEnabled","Account Status Analysis","User Management"
Q034,"Show me MFA compliance summary","SELECT CASE WHEN IsMFADisabled = 1 THEN 'MFA Disabled' ELSE 'MFA Enabled' END as MFAStatus, COUNT(*) as UserCount FROM UserRecords GROUP BY IsMFADisabled","MFA Compliance Summary","Security Compliance"
Q035,"Show me email trends over different periods","SELECT 'Last 7 Days' as Period, SUM(EmailSent_D7) as TotalSent, SUM(EmailReceive_D7) as TotalReceived FROM UserRecords UNION ALL SELECT 'Last 30 Days', SUM(EmailSent_D30), SUM(EmailReceive_D30) FROM UserRecords UNION ALL SELECT 'Last 90 Days', SUM(EmailSent_D90), SUM(EmailReceive_D90) FROM UserRecords UNION ALL SELECT 'Last 180 Days', SUM(EmailSent_D180), SUM(EmailReceive_D180) FROM UserRecords","Email Trend Analysis","Communication Analysis"
Q036,"Show me meeting trends over different periods","SELECT 'Last 7 Days' as Period, SUM(Meeting_Created_Count_7) as TotalCreated, SUM(Meeting_Interacted_Count_7) as TotalInteractions FROM UserRecords UNION ALL SELECT 'Last 30 Days', SUM(Meeting_Created_Count_30), SUM(Meeting_Interacted_Count_30) FROM UserRecords UNION ALL SELECT 'Last 90 Days', SUM(Meeting_Created_Count_90), SUM(Meeting_Interacted_Count_90) FROM UserRecords UNION ALL SELECT 'Last 180 Days', SUM(Meeting_Created_Count_180), SUM(Meeting_Interacted_Count_180) FROM UserRecords","Meeting Trend Analysis","Collaboration Analysis"
Q037,"Show me users who never signed in","SELECT UserID, Mail, DisplayName, Department, AccountEnabled FROM UserRecords WHERE LastSignInDateTime IS NULL","Never Signed In Users","User Activity"
Q038,"Show me stale user accounts (no sign-in for 90+ days)","SELECT UserID, Mail, DisplayName, Department, LastSignInDateTime FROM UserRecords WHERE LastSignInDateTime < DATEADD(day, -90, GETDATE()) OR LastSignInDateTime IS NULL","Stale Account Analysis","User Activity"
Q039,"Show me active users by sign-in recency","SELECT CASE WHEN LastSignInDateTime >= DATEADD(day, -7, GETDATE()) THEN 'Last 7 days' WHEN LastSignInDateTime >= DATEADD(day, -30, GETDATE()) THEN 'Last 30 days' WHEN LastSignInDateTime >= DATEADD(day, -90, GETDATE()) THEN 'Last 90 days' ELSE 'More than 90 days' END as SignInRecency, COUNT(*) as UserCount FROM UserRecords WHERE LastSignInDateTime IS NOT NULL GROUP BY CASE WHEN LastSignInDateTime >= DATEADD(day, -7, GETDATE()) THEN 'Last 7 days' WHEN LastSignInDateTime >= DATEADD(day, -30, GETDATE()) THEN 'Last 30 days' WHEN LastSignInDateTime >= DATEADD(day, -90, GETDATE()) THEN 'Last 90 days' ELSE 'More than 90 days' END","Sign-in Recency Analysis","User Activity"
Q040,"Show me email engagement levels","SELECT CASE WHEN EmailSent_D30 > 100 OR EmailReceive_D30 > 500 THEN 'High Engagement' WHEN EmailSent_D30 > 20 OR EmailReceive_D30 > 100 THEN 'Medium Engagement' WHEN EmailSent_D30 > 0 OR EmailReceive_D30 > 0 THEN 'Low Engagement' ELSE 'No Engagement' END as EngagementLevel, COUNT(*) as UserCount FROM UserRecords GROUP BY CASE WHEN EmailSent_D30 > 100 OR EmailReceive_D30 > 500 THEN 'High Engagement' WHEN EmailSent_D30 > 20 OR EmailReceive_D30 > 100 THEN 'Medium Engagement' WHEN EmailSent_D30 > 0 OR EmailReceive_D30 > 0 THEN 'Low Engagement' ELSE 'No Engagement' END","Email Engagement Analysis","Communication Analysis"
Q041,"Show me departments with security risks (MFA disabled)","SELECT Department, COUNT(*) as UsersWithMFADisabled FROM UserRecords WHERE IsMFADisabled = 1 AND Department IS NOT NULL GROUP BY Department ORDER BY UsersWithMFADisabled DESC","Department Security Analysis","Security Compliance"
Q042,"Show me geographic distribution of active users","SELECT Country, COUNT(*) as ActiveUsers FROM UserRecords WHERE AccountEnabled = 1 AND Country IS NOT NULL GROUP BY Country ORDER BY ActiveUsers DESC","Active User Geography","User Distribution"
Q043,"Show me user onboarding analysis (recent account creation)","SELECT UserID, Mail, DisplayName, Department, Country FROM UserRecords WHERE RowVersion IS NOT NULL ORDER BY RowVersion DESC","Recent User Analysis","User Management"
Q044,"Show me collaboration patterns by department","SELECT Department, AVG(CAST(Meeting_Created_Count_30 AS FLOAT)) as AvgMeetingsCreated, AVG(CAST(Meeting_Interacted_Count_30 AS FLOAT)) as AvgMeetingInteractions FROM UserRecords WHERE Department IS NOT NULL GROUP BY Department ORDER BY AvgMeetingsCreated DESC","Department Collaboration Analysis","Collaboration Analysis"
Q045,"Show me external collaboration (guest users activity)","SELECT UserID, Mail, DisplayName, UserType, EmailSent_D30, Meeting_Created_Count_30 FROM UserRecords WHERE UserType = 'Guest' OR UserType LIKE '%Guest%'","External Collaboration Analysis","Collaboration Analysis"
Q046,"Show me service adoption rates","SELECT 'Exchange Online' as Service, COUNT(*) as UsersWithActivity FROM UserRecords WHERE LastExchangeOnlineLogin IS NOT NULL UNION ALL SELECT 'Entra ID', COUNT(*) FROM UserRecords WHERE LastEntraIdLogin IS NOT NULL","Service Adoption Analysis","Service Usage"
Q047,"Show me top email domains","SELECT RIGHT(Mail, LEN(Mail) - CHARINDEX('@', Mail)) as EmailDomain, COUNT(*) as UserCount FROM UserRecords WHERE Mail IS NOT NULL AND CHARINDEX('@', Mail) > 0 GROUP BY RIGHT(Mail, LEN(Mail) - CHARINDEX('@', Mail)) ORDER BY UserCount DESC","Email Domain Analysis","User Management"
Q048,"Show me users with multiple tenant codes","SELECT TenantCode, COUNT(*) as UserCount FROM UserRecords WHERE TenantCode IS NOT NULL GROUP BY TenantCode ORDER BY UserCount DESC","Multi-tenant Analysis","Organizational Structure"
Q049,"Show me user activity correlation","SELECT Department, COUNT(*) as TotalUsers, SUM(CASE WHEN EmailSent_D30 > 0 THEN 1 ELSE 0 END) as EmailActiveUsers, SUM(CASE WHEN Meeting_Created_Count_30 > 0 THEN 1 ELSE 0 END) as MeetingActiveUsers FROM UserRecords WHERE Department IS NOT NULL GROUP BY Department ORDER BY TotalUsers DESC","Activity Correlation Analysis","User Activity"
Q050,"Show me comprehensive user summary","SELECT COUNT(*) as TotalUsers, SUM(CASE WHEN AccountEnabled = 1 THEN 1 ELSE 0 END) as ActiveUsers, SUM(CASE WHEN IsLicensed = 1 THEN 1 ELSE 0 END) as LicensedUsers, SUM(CASE WHEN IsMFADisabled = 0 THEN 1 ELSE 0 END) as MFAEnabledUsers, COUNT(DISTINCT Department) as TotalDepartments, COUNT(DISTINCT Country) as TotalCountries FROM UserRecords","Overall Summary Dashboard","Executive Summary"